---  
layout: post  
title: 自动统计知乎回答的代码教程就在这里  
name: 2024-05-05-自动统计知乎回答的代码教程就在这里  
subtitle:   
categories:   
author:  
  - 雨天狂奔  
share: true  
mathjax:   
---  
  
  
[![老K玩代码](https://picx.zhimg.com/v2-5c85ada7b953eb4e01901952f87bd2a8_l.jpg?source=172ae18b)](https://www.zhihu.com/people/zhao-yin-jing)  
  
[老K玩代码](https://www.zhihu.com/people/zhao-yin-jing)  
  
高级技术顾问 | 从业10年 | 分享案例2000+  
  
​关注他  
  
15 人赞同了该文章  
  
> **老K经常在知乎对感兴趣的回答进行抓取和统计，并通过这种方式对整个问题有个综合的认识，再依照这个认识深入了解自己感兴趣的部分。**    
> **我不仅用这种方式更有效地浏览知乎上自己感兴趣的问题，也通过这个办法将分析结果提供给知友们了解。**    
> **这也确实是一个利用代码，更便捷获取和整理海量信息的办法。老K在知乎上也收到很多私信索取代码。**    
> **老K本着“授人以鱼不如授人以渔”的原则，给大家开篇介绍这部分代码的编写。**    
  
废话不多说，先上代码的视频：  
  
[](https://m.bilibili.com/video/BV18D4y1o7VY)[https://m.bilibili.com/video/BV18D4y1o7VY](https://m.bilibili.com/video/BV18D4y1o7VY)​m.bilibili.com/video/BV18D4y1o7VY  
  
    
  
---  
  
**以下是文字版：**  
  
## 1. 安装必要组件  
  
- 首先，我们会**用python这种胶水语言来实现接下来的功能**。如果对这部分不了解的，建议关注《老K玩Python》的知乎专栏或关注《老K玩代码》频道和我交流，全网同号，老K会在后续更新相关的教程，本文就不把精力放在基础的配置和python语言环境的安装上了。  
- 安装`selenium`库：    
    打开cmd  
  
```text  
pip install selenium  
```  
  
- 安装`chromedriver`驱动：    
    访问网站`https://sites.google.com/a/chromium.org/chromedriver/downloads`    
    （可能需要vpn才能访问）    
    找到和你`chrome`浏览器版本匹配的`chromedriver`进行下载，并解压安装到项目根目录。    
      
  
## 2. 导入第三方库，设置初始变量  
  
```python  
# encoding: utf-8  
from selenium.webdriver import Chrome  
from selenium.webdriver.common.keys import Keys  
driver = Chrome('chromdriver.exe')  
```  
  
- 因为我们获取的文本主要是汉字，所以设置一下编码为`utf-8`  
- 导入的`Chrome`是`selenium`对`Chrome`浏览器的模拟功能  
- 导入的`Keys`是`selenium`对键盘的模拟功能  
- 下载的`chromedriver.exe`需要和自己的`chrome`版本号匹配  
- path参数对应的路径要有`chromedriver.exe`文件，由于这个项目里，执行文件在项目根目录里，所以`path`参数设置为“`chromedriver.exe`”  
  
## 3. 请求页面  
  
```python  
url = "your question url"  
driver.get(url)  
```  
  
- `url`变量设置为您要获取的知乎问题页面地址  
- 用`driver.get()`方法请求网页  
  
## 4. 加载回答  
  
```python  
for i in range(100):  
    driver.find_element_by_tag_name('body').send_keys(Keys.PAGE_DOWN * 10)  
    driver.find_element_by_tag_name('body').send_keys(Keys.PAGE_UP)  
```  
  
- 通过`for`循环，不断向下加载内容  
- 通过对`body`元素传入键盘`PgDn`按钮，实现页面的向下滚动功能  
- 因为`reachBottom`的监听逻辑可能出现问题，对`body`元素传入键盘`PgUp`按钮避免相应bug。  
  
## 5. 获取全部回答文本  
  
```python  
answers = list()  
for i in driver.find_elements_by_class_name('List-item'):  
    inner_text = i.find_element_by_class_name('RichText').text  
    answers.append(inner_text)  
```  
  
- 初始化一个`list`，用于存储回答文本  
- 通过`for`循环，找到需要爬取的`class_name`，读取所有回答  
- 把获取到的回答文本存入到`answers`里  
  
## 6. 对结果进行统计  
  
```python  
result = {  
    'keyword1': 0,  
    ' keyword2': 0  
}  
for i in result:  
    for ans in answers:  
        if i in ans:  
            result[i] += 1  
print(result)  
```  
  
- `keywords`为一个字典，以需要检索的关键词为键，值初始化为`0`  
- 通过`for`循环遍历所有回答，若出现关键词，则在相应的值上`+1`  
- 最后打印结果  
  
---  
  
---  
  
至此，统计知乎回答的功能就基本实现了，当然还有许多可以优化的地方，比如：    
1. 加载过程中会出现登陆弹出，除了手动关闭，我们还可以用代码替我们关闭，办法是找到弹窗的关闭按钮，用`click()`方法关闭弹窗；    
2. 用`for`循环加载内容，并不是最有效率的做法，我们可以设置一个“**是否已经加载到底部**”的条件判断，用`while`循环来实现；    
    
大家可以自己动脑筋解决一下上述问题，试写一下完整代码。  
  
最后，除了词频，还有许多有价值的内容可以获取和统计；    
另外，设计一个适合你的`result`数据结构也是很重要的部分；    
大家可以开动脑筋思考一下如何完善和定制属于你自己的代码，也欢迎随时和我微信交流。  
  
---  
  
分享更多项目，关注知乎专栏《`老K玩Python`》或关注频道`老K玩代码` ，全网同名